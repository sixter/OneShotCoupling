"0","getJ2 <- function(k, d, a, b, rh, eh, G){"
"0","  num <- log(eh*log(d*a*(1-b^d)*rh)) - log(-log(1-b^d)*a^(k+1)*(1-b^d)*rh)"
"0","  denom <- log(1-b^d) - log(d*a*(1-b^d)*rh)"
"0","  j <- pmax(pmin(num/denom,k),0)"
"0","  return(j)"
"0","}"
"0",""
"0","getBound2 <- function(k, d, c){"
"0","  "
"0","  b <- 2 * (pnorm(4*c/sqrt(3))-pnorm(2*c/sqrt(3)) )"
"0","  a <- 4*(c^2+1)/(c^2+10)"
"0","  rh <- (2*((3+c^2)/4)+1)/(1-b)^2 #rh is bounded above by E[x^2+y^2+1|x=c, y=-c]"
"0","  eh <- 4"
"0","  G <- a*(1-b)*rh"
"0","  G <- ifelse(G<1, 1, G)"
"0","  "
"0","  j <- getJ2(k, d, a, b, rh, eh, G)"
"0","  A <- (1-b^d)^j"
"0","  B <- a^(-k) * G*d^(j-1) * (d * eh + 1)"
"0","  bound <- A + B"
"0","  return(bound)"
"0","}"
"0",""

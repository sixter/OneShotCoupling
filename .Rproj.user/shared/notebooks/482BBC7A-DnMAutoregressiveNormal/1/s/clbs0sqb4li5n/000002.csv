"0","# getBound <- function(k, M, X0, Y0){"
"0","#   d <- length(X0)"
"0","#   e <- matrix(rep(0,d*length(k)), ncol = length(k))"
"0","#   "
"0","#   A <- t(chol(M)) #A = D + L where D is a diagonal matrix, L a lower triangular matrix (with zeros along diagonal)"
"0","#   D <- diag(diag(A), nrow=d, ncol=d) # D provides the variances for each coordinate"
"0","#   m <- getm(A, D, d) # m provides the mean for each coordinate"
"0","#   for (i in 1:d){"
"0","#     e[i,] <- getE(k, i, m, D)"
"0","#   }"
"0","#   bound <- 1-apply(e, 2, prod)"
"0","#   return(bound)"
"0","# }"
"0","# "
"0","# # Returns the coupling bound when "
"0","# getE <- function(k, i, m, D){"
"0","#   q <- -2^(-k)*abs(m[i])/(sqrt(3)*D[i,i])"
"0","#   e <- 2*pnorm(q)"
"0","#   return(e)"
"0","# }"
"0","# "
"0","# getm <- function(A, D, d){"
"0","#   L <- A-D"
"0","#   MM <- L %*% inv(A)"
"0","#   m <- (diag(d)-MM) %*% (X0-Y0)"
"0","#   return(m)"
"0","# }"
